1000个线程同时运行，怎么防止不卡？

**1000 多个并发线程，10 台机器，每台机器 4 核，设计线程池大小。**

要设计一款聊天软件，你打算采用什么方案？

图片上传的功能，后端开发一个接口,前端传图片到后端上面。中间过程网络通信的过程是什么样的？

优化图片上传的吞吐量怎么优化？





## 如何准备系统设计题（场景题）



### 系统的具体要求

1. 包含哪些功能。
2. 系统达到多少QPS？



###  抽象设计

![image-20230622155507865](./image/image-20230622155507865.png)



### 考虑系统需要优化的点

1. 是否需要部署多台机器进行负载均衡？
2. 数据库是否需要指定字段索引？是否需要读写分离？是否需要缓存？
3. 数据库是否需要分库分表？
4. 是否需要分布式系统？
5.   .... 



### 从三方面考虑

1. 高性能架构设计：常见性能优化手段比如引入 读写分离、缓存、负载均衡、异步 
2. 高可用性：CAP理论和BASE理论、通过集群来提高系统整体稳定性、超时和重试机制、应对接口级故障：降级、熔断、限流、排队。
3. 高扩展架构设计：责任链、SPI热拔插技术。



### 技术选型

实现同样的功能，一般会有多种技术选择方案，比如缓存用Redis 还是 Memcached、网关用 Spring Cloud Gateway 还是Netflix Zuul2 。 很多时候，面试官在系统设计面过程中会具体到技术的选型，因而，你需要区分不同技术的优缺点



### 相关性能指标



#### 性能指标

**并发数：**

1. QPS：每秒可执行的查询次数；
2. TPS：服务器每秒处理的事务数；



**吞吐量：**

1. QPS（TPS） = 并发数/平均响应时间(RT)
2. 并发数 = QPS * 平均响应时间(RT)



**系统活跃度**

1. PV：网站点击量
2. UV：一天独立访客的次数。 即同一个客户访问多次只算1个点击量。
3. DAU：活跃用户数量。
4. MAU：月活跃用人数



## 秒杀系统



