# 前置知识点

[(47条消息) 教你如何迅速秒杀掉：99%的海量数据处理面试题_v_JULY_v的博客-CSDN博客](https://blog.csdn.net/v_july_v/article/details/7382693)

1. 分治：多层划分、MapReduce 

2. 排序：快速排序、桶排序、堆排序 
2. 数据结构：堆、位图、布隆过滤器、倒排索引、二叉树、Trie树、B树，红黑树 
2. Hash映射：hashMap、simhash、局部敏感哈希



### 前缀数

前缀树是哈希树的一种变形，特点就是利用字符串的公共前缀来减少查询时间，最大限度地减少无谓的字符串比较。

核心思想就是空间换时间，利用字符串的公共前缀来降低查询时间的开销以达到提高效率的目的。

**应用场景：**统计和排序大量的字符串

**前缀树的3个基本性质：**

1. 根节点不包含字符，除根节点外每一个节点都只包含一个字符。
2. 从根节点到某一节点，路径上经过的字符连接起来，为该节点对应的字符串。
3. 每个节点的所有子节点包含的字符都不相同。



### 哈希分区

通过按照数据的key、或者用户指定的一个或者多个字段计算哈希，然后将计算后的哈希与计算节点进行映射，从而将不同哈希值的数据分布到不同节点上。可以参考一致性哈希算法。



### 位图

**位图**，就是用一个或多个 bit 来标记某个元素对应的值，而键就是该元素。采用位作为单位来存储数据，可以大大节省存储空间。



### 布隆过滤器

类似于位图单不限于整数，本质上布隆过滤器是一种数据结构，特点是高效地插入和查询，可以用来告诉你 **“某样东西一定不存在或者可能存在”**。

一个布隆过滤器可以使用多个不同的哈希函数来生成多个哈希值，并对每个生成的哈希值指向的 bit 位置 1。



### MapReduce

`MapReduce`是一个由google提出的**分布式运算程序**的编程框架。





## 单机单核+受限内存

- 将原文件中的数据切割成M小文件，如果小文件仍大于内存大小，继续采用Hash的方法对数据文件进行分割，直到每个小文件小于内存大小，这样每个文件可放到内存中处理。采用（1）的方法依次处理每个小文件。



## 多机+受限内存

**数据分发 + （3）**

- 将数据分发到多台机器上，每台机器采用（3）中的策略解决本地的数据。可采用hash+socket方法进行数据分发。

**MapReduce**

- top K问题很适合采用MapReduce框架解决，用户只需编写一个Map函数和两个Reduce 函数，然后提交到Hadoop
  - 首先根据数据值或者把数据hash(MD5)后的值按照范围划分到不同的机器上，最好可以让数据划分后一次读入内存，这样不同的机器负责处理不同的数值范围，实际上就是Map。
  - 得到结果后，各个机器只需拿出各自出现次数最多的前N个数据，然后汇总，选出所有的数据中出现次数最多的前N个数据，这实际上就是Reduce过程。
  - 对于Map函数，采用Hash算法，将Hash值相同的数据交给同一个Reduce task；对于第一个Reduce函数，采用HashMap统计出每个词出现的频率，对于第二个Reduce 函数，统计所有Reduce task，输出数据中的top K即可。
    



# 40亿个QQ号，限制1G内存，如何去重？

大数据去重题目中，可以考虑使用Bitmap来实现。使用 Bitmap 的话，一个数字只需要占用 1 个 bit。 原理就类似于布隆过滤器

